# This file was generated by Rcpp::compileAttributes
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' @title Color graph of sparse Hessian
#' @description Generate valid cyclic coloring of variables that is consistent with estimating sparse Hessian with a triangle substitution method.
#' @param pntr,idx row pointers and column indices (CSC or CSR format; same since Hessian matrix is symmetric). Must use zero-based indexing.
#' @param nvars Dimension of Hessian (number of variables)
#' @param LT true if ordering with degree in lower triangle, and false (default) if using full Hessian.  Included only for testing, to see if it matters (I don't think it does).
#' @return A list.  Each element of the list represents a color, and contains an integer vector with the indices of the variables with that color.  Indices are zero-based.
color_graph <- function(pntr, idx, nvars, LT = FALSE) {
    .Call('sparseHessianFD_color_graph', PACKAGE = 'sparseHessianFD', pntr, idx, nvars, LT)
}

#' @title Estimate sparse Hessian
#' @description Estimate Hessian using triangular subsitution algorithm
#' @param Y Matrix of finite differences
#' @param colors Vector of length nvars that identifies color of each variable
#' @param W A list.  Each element represents a color, and contains an integer vector with the indices of the variables with that color.  Indexing is zero-based.
#' @param jCol,ipntr Column indices and row pointers for non-zero elements of lower triangle of Hessian.
#' @param delta Perturbation factor used to compute finite differences.
#' @param nvars Dimension of Hessian (number of variables)
#' @param nnz Number of non-zero elements in the lower triangle of the Hessian.
#' @return A sparse Hessian of class dgCMatrix.
subst <- function(Y, colors, W, jCol, ipntr, delta, nvars, nnz) {
    .Call('sparseHessianFD_subst', PACKAGE = 'sparseHessianFD', Y, colors, W, jCol, ipntr, delta, nvars, nnz)
}

#' @title Estimate sparse Hessian
#' @description Estimate Hessian using triangular subsitution algorithm
#' @param Y Matrix of finite differences
#' @param colors Vector of length nvars that identifies color of each variable
#' @param W A list.  Each element represents a color, and contains an integer vector with the indices of the variables with that color.  Indexing is zero-based.
#' @param jCol,ipntr Column indices and row pointers for non-zero elements of lower triangle of Hessian.
#' @param delta Perturbation factor used to compute finite differences.
#' @param nvars Dimension of Hessian (number of variables)
#' @param nnz Number of non-zero elements in the lower triangle of the Hessian.
#' @return A sparse Hessian of class dgCMatrix.
subst2 <- function(Y, colors, W, jCol, ipntr, delta, nvars, nnz) {
    .Call('sparseHessianFD_subst2', PACKAGE = 'sparseHessianFD', Y, colors, W, jCol, ipntr, delta, nvars, nnz)
}

